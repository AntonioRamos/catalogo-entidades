
<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rede Ageas ‚Äì Mapa</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>
<body>
  <header>
    <div class="nav">
      <img class="logo" src="https://www.ageas.pt/media/4874/logotipo-da-ageas-seguros.png" alt="Ageas Seguros" />
      <div class="spacer"></div>
      <a class="btn secondary" href="index.html">Listagem</a>
    </div>
  </header>
  <div class="map-wrap">
    <div id="map"></div>
  </div>
  <script>
    const map = L.map('map').setView([39.6945, -8.1306], 7);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '&copy; OpenStreetMap' }).addTo(map);

    fetch('entidades.geojson').then(r => r.json()).then(geo => {
      const layer = L.geoJSON(geo, {
        onEachFeature: (f, layer) => {
          const p = f.properties;
          const caps = ['urgencia','ambulatorio','rx','imagiologia','fisioterapia','cirurgia','internamento']
            .filter(k => p[k])
            .map(k => `<span class="badge">${k}</span>`)
            .join(' ');
          layer.bindPopup(`
            <div style="min-width:260px">
              <div style="font-weight:800;">${p.nome || p.estabelecimento || p.entidade}</div>
              <div style="color:var(--muted); margin:2px 0 6px 0;">${p.tipificacao || ''}</div>
              <div>${p.morada || ''} ${p.codigo_postal ? ' ‚Ä¢ ' + p.codigo_postal : ''}</div>
              <div>${p.localidade || ''} ${p.distrito ? ' ‚Ä¢ ' + p.distrito : ''}</div>
              <div class="badges" style="margin-top:6px;">${caps}</div>
              <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
                ${p.telefone ? `<a href="tel:${p.telefone}" class="badge">üìû ${p.telefone}</a>` : ''}
                ${p.email ? `<a href="mailto:${p.email}" class="badge">‚úâÔ∏è ${p.email}</a>` : ''}
              </div>
            </div>
          `);
        }
      }).addTo(map);
      try { map.fitBounds(layer.getBounds(), { padding: [20,20] }); } catch(e) {}
    });
  </script>
</body>
</html>
